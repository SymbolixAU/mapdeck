<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add Heatmap — add_heatmap • mapdeck</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Add Heatmap — add_heatmap" />
<meta property="og:description" content="The Heatmap Layer can be used to visualise spatial distribution of data.
It implements Gaussian Kernel Density Estimation to render the heatmaps." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapdeck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mapdeck.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/benchmarks.html">Benchmarks</a>
    </li>
    <li>
      <a href="../articles/colours.html">Colours</a>
    </li>
    <li>
      <a href="../articles/google_map.html">Google Map</a>
    </li>
    <li>
      <a href="../articles/issues.html">Why isn't it working?</a>
    </li>
    <li>
      <a href="../articles/layers.html">Layers</a>
    </li>
    <li>
      <a href="../articles/legends.html">Legends</a>
    </li>
    <li>
      <a href="../articles/tips_tricks.html">Tips &amp; Tricks</a>
    </li>
    <li>
      <a href="../articles/trips.html">Trips</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SymbolixAU/mapdeck/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add Heatmap</h1>
    <small class="dont-index">Source: <a href='https://github.com/SymbolixAU/mapdeck/blob/master/R/map_layer_heatmap.R'><code>R/map_layer_heatmap.R</code></a></small>
    <div class="hidden name"><code>add_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Heatmap Layer can be used to visualise spatial distribution of data.
It implements Gaussian Kernel Density Estimation to render the heatmaps.</p>
    </div>

    <pre class="usage"><span class='fu'>add_heatmap</span>(
  <span class='no'>map</span>,
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'>get_map_data</span>(<span class='no'>map</span>),
  <span class='kw'>lon</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>lat</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>polyline</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>weight</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>colour_range</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>radius_pixels</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>intensity</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>layer_id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>update_view</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>focus_layer</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>6</span>,
  <span class='kw'>transitions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>map</th>
      <td><p>a mapdeck map object</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data to be used in the layer. All coordinates are expected to be
EPSG:4326 (WGS 84) coordinate system</p></td>
    </tr>
    <tr>
      <th>lon</th>
      <td><p>column containing longitude values</p></td>
    </tr>
    <tr>
      <th>lat</th>
      <td><p>column containing latitude values</p></td>
    </tr>
    <tr>
      <th>polyline</th>
      <td><p>optional column of <code>data</code> containing the polylines, if using encoded polylines</p></td>
    </tr>
    <tr>
      <th>weight</th>
      <td><p>the weight of each value. Default 1</p></td>
    </tr>
    <tr>
      <th>colour_range</th>
      <td><p>vector of 6 hex colours</p></td>
    </tr>
    <tr>
      <th>radius_pixels</th>
      <td><p>Radius of the circle in pixels, to which the weight of an object is distributed</p></td>
    </tr>
    <tr>
      <th>intensity</th>
      <td><p>Value that is multiplied with the total weight at a pixel to
obtain the final weight. A value larger than 1 biases the output color towards
the higher end of the spectrum, and a value less than 1 biases the output
color towards the lower end of the spectrum</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>The HeatmapLayer reduces the opacity of the pixels with relatively
low weight to create a fading effect at the edge.
A larger threshold smoothens the boundaries of color blobs, while making pixels
with low relative weight harder to spot (due to low alpha value).
Threshold is defined as the ratio of the fading weight to the max weight, between 0 and 1.
For example, 0.1 affects all pixels with weight under 10% of the max.</p></td>
    </tr>
    <tr>
      <th>layer_id</th>
      <td><p>single value specifying an id for the layer. Use this value to
distinguish between shape layers of the same type. Layers with the same id are likely
to conflict and not plot correctly</p></td>
    </tr>
    <tr>
      <th>update_view</th>
      <td><p>logical indicating if the map should update the bounds to include this layer</p></td>
    </tr>
    <tr>
      <th>focus_layer</th>
      <td><p>logical indicating if the map should update the bounds to only include this layer</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>number of digits for rounding coordinates</p></td>
    </tr>
    <tr>
      <th>transitions</th>
      <td><p>list specifying the duration of transitions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>add_heatmap</code> supports POINT and MULTIPOINT sf objects</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>note</h2>

    


<p>The current version of this layer is supported only for WebGL2 enabled browswers
So you may find it doesn't render in the RStudio viewer.</p>
    <h2 class="hasAnchor" id="transitions"><a class="anchor" href="#transitions"></a>transitions</h2>

    


<p>The transitions argument lets you specify the time it will take for the shapes to transition
from one state to the next. Only works in an interactive environment (Shiny)
and on WebGL-2 supported browsers and hardware.</p>
<p>The time is in milliseconds</p>
<p>Available transitions for heatmap</p>
<p>list(
intensity = 0,
threshold = 0,
radius_pixels = 0
)</p>
    <h2 class="hasAnchor" id="data"><a class="anchor" href="#data"></a>data</h2>

    


<p>If the <code>data</code> is a simple feature object, the geometry column is automatically
detected. If the sf object contains more than one geometry column and you want to use a specific one,
you'll need to set the active geometry using <code>sf::st_geometry( x ) &lt;- "your_column" </code>,
where <code>"your_column"</code> is the name of the column you're activating. See <code><a href='https://rdrr.io/pkg/sf/man/st_geometry.html'>?sf::st_geometry</a></code></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='co'>## You need a valid access token from Mapbox</span>
<span class='no'>key</span> <span class='kw'>&lt;-</span> <span class='st'>'abc'</span>
<span class='fu'><a href='set_token.html'>set_token</a></span>( <span class='no'>key</span> )

<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(
<span class='st'>'https://raw.githubusercontent.com/uber-common/deck.gl-data/master/'</span>,
<span class='st'>'examples/3d-heatmap/heatmap-data.csv'</span>
))

<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='no'>df</span>[ !<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>df</span>$<span class='no'>lng</span>), ]
<span class='no'>df</span>$<span class='no'>weight</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>df</span>), <span class='kw'>replace</span> <span class='kw'>=</span> <span class='no'>T</span>)

<span class='fu'><a href='mapdeck.html'>mapdeck</a></span>( <span class='kw'>style</span> <span class='kw'>=</span> <span class='fu'><a href='mapdeck_style.html'>mapdeck_style</a></span>(<span class='st'>'dark'</span>), <span class='kw'>pitch</span> <span class='kw'>=</span> <span class='fl'>45</span> ) <span class='kw'>%&gt;%</span>
<span class='fu'>add_heatmap</span>(
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>df</span>
  , <span class='kw'>lat</span> <span class='kw'>=</span> <span class='st'>"lat"</span>
  , <span class='kw'>lon</span> <span class='kw'>=</span> <span class='st'>"lng"</span>
  , <span class='kw'>weight</span> <span class='kw'>=</span> <span class='st'>"weight"</span>,
  , <span class='kw'>layer_id</span> <span class='kw'>=</span> <span class='st'>"heatmap_layer"</span>
)</div><div class='output co'>#&gt; <span class='error'>Error in google_dispatch(map, method, google_map = {    x = map$x$calls    if (is.null(x))         x = list()    n = length(x)    x[[n + 1]] = list(functions = method, args = args)    map$x$calls = x    map}, google_map_update = {    invoke_remote(map, method, args)}): Invalid map parameter</span></div><div class='input'>
<span class='co'>## as an sf object</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>sfheaders</span>)
<span class='no'>sf</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sfheaders</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sfheaders/man/sf_point.html'>sf_point</a></span>( <span class='no'>df</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"lng"</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"lat"</span>)

<span class='fu'><a href='mapdeck.html'>mapdeck</a></span>( <span class='kw'>style</span> <span class='kw'>=</span> <span class='fu'><a href='mapdeck_style.html'>mapdeck_style</a></span>(<span class='st'>'dark'</span>), <span class='kw'>pitch</span> <span class='kw'>=</span> <span class='fl'>45</span> ) <span class='kw'>%&gt;%</span>
<span class='fu'>add_heatmap</span>(
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sf</span>
  , <span class='kw'>weight</span> <span class='kw'>=</span> <span class='st'>"weight"</span>,
  , <span class='kw'>layer_id</span> <span class='kw'>=</span> <span class='st'>"heatmap_layer"</span>
)</div><div class='output co'>#&gt; <span class='error'>Error in find_lat_column(dataNames, layer_call, TRUE): Couldn't infer latitude column for add_heatmap</span></div><div class='input'>
# }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Cooley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


