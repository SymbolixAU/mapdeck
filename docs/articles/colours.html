<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Colours • mapdeck</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Colours">
<meta property="og:description" content="mapdeck">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapdeck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.3001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mapdeck.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmarks.html">Benchmarks</a>
    </li>
    <li>
      <a href="../articles/colours.html">Colours</a>
    </li>
    <li>
      <a href="../articles/google_map.html">Google Map</a>
    </li>
    <li>
      <a href="../articles/issues.html">Why isn't it working?</a>
    </li>
    <li>
      <a href="../articles/layers.html">Layers</a>
    </li>
    <li>
      <a href="../articles/legends.html">Legends</a>
    </li>
    <li>
      <a href="../articles/tips_tricks.html">Tips &amp; Tricks</a>
    </li>
    <li>
      <a href="../articles/trips.html">Trips</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SymbolixAU/mapdeck/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Colours</h1>
                        <h4 class="author">David Cooley</h4>
            
            <h4 class="date">2020-06-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/SymbolixAU/mapdeck/blob/master/vignettes/colours.Rmd"><code>vignettes/colours.Rmd</code></a></small>
      <div class="hidden name"><code>colours.Rmd</code></div>

    </div>

    
    
<div id="colours" class="section level1">
<h1 class="hasAnchor">
<a href="#colours" class="anchor"></a>Colours</h1>
<p>The easiest way to colour your data is to pass the column of your <code>data</code> you want coloured to either the <code>stroke_colour</code> or <code>fill_colour</code> argument (depending on the layer you’re using).</p>
<div id="fill-and-stroke" class="section level2">
<h2 class="hasAnchor">
<a href="#fill-and-stroke" class="anchor"></a>fill and stroke</h2>
<p>For this demonstration I’m using a simple feature <code>sf</code> object of polygons denoting various regions in Melbourne (taken from the <code>spatialwidget</code> library)</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mapdeck</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)</pre></body></html></div>
<pre><code>## Linking to GEOS 3.7.2, GDAL 2.4.2, PROJ 5.2.0</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">sf</span> <span class="kw">&lt;-</span> <span class="kw pkg">spatialwidget</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/spatialwidget/man/widget_melbourne.html">widget_melbourne</a></span>
<span class="no">sf</span></pre></body></html></div>
<pre><code>## Simple feature collection with 41 features and 3 fields
## geometry type:  POLYGON
## dimension:      XY
## bbox:           xmin: 144.8889 ymin: -37.89173 xmax: 145.0453 ymax: -37.7325
## CRS:            EPSG:4326
## First 10 features:
##                        SA2_NAME           SA3_NAME AREASQKM
## 1                    Abbotsford              Yarra   1.7405
## 2                   Albert Park       Port Phillip   4.6747
## 3        Alphington - Fairfield    Darebin - South   2.8853
## 4                      Armadale Stonnington - West   2.1835
## 5                    Ascot Vale           Essendon   3.8361
## 6                     Brunswick Brunswick - Coburg   5.1425
## 7                Brunswick East Brunswick - Coburg   2.1680
## 8                Brunswick West Brunswick - Coburg   3.1795
## 9                       Carlton     Melbourne City   1.8185
## 10 Carlton North - Princes Hill              Yarra   2.3042
##                          geometry
## 1  POLYGON ((144.9925 -37.8024...
## 2  POLYGON ((144.9449 -37.8437...
## 3  POLYGON ((145.0204 -37.7654...
## 4  POLYGON ((145.0117 -37.8535...
## 5  POLYGON ((144.8994 -37.7704...
## 6  POLYGON ((144.9497 -37.7627...
## 7  POLYGON ((144.9734 -37.7620...
## 8  POLYGON ((144.9341 -37.7596...
## 9  POLYGON ((144.9643 -37.7984...
## 10 POLYGON ((144.9594 -37.7847...</code></pre>
<p>This first map is simply showing the regions coloured according to its name</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
  )</pre></body></html></div>
<div class="figure">
<img src="img/articles/fill_colour_viridis.png" alt=""><p class="caption">fill viridis</p>
</div>
<p>The colour scheme defaults to viridis. You can change it with the <code>palette</code> argument by using one of the other palettes available in <code><a href="https://rdrr.io/pkg/colourvalues/man">library(colourvalues)</a></code></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co">## to see a list of colours</span>
<span class="co">## colourvalues::colour_palettes()</span>

<span class="co">## plot of colours</span>
<span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/show_colours.html">show_colours</a></span>()</pre></body></html></div>
<p><img src="colours_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>or by using a matrix palette.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co">## using another viridis colour palette</span>

<span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
    , <span class="kw">palette</span> <span class="kw">=</span> <span class="st">"inferno"</span>
  )</pre></body></html></div>
<div class="figure">
<img src="img/articles/fill_colour_inferno.png" alt=""><p class="caption">fill inferno</p>
</div>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">m</span> <span class="kw">&lt;-</span> <span class="kw pkg">grDevices</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRamp</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"yellow"</span>))( (<span class="fl">1</span>:<span class="fl">256</span>)/<span class="fl">256</span> )

<span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
    , <span class="kw">palette</span> <span class="kw">=</span> <span class="no">m</span>
  )</pre></body></html></div>
<div class="figure">
<img src="img/articles/fill_manual.png" alt=""><p class="caption">fill manual</p>
</div>
</div>
<div id="opacity" class="section level2">
<h2 class="hasAnchor">
<a href="#opacity" class="anchor"></a>Opacity</h2>
<p>You can change the transparency of the colours by specifying a numeric column of data to either <code>fill_opacity</code> or <code>stroke_opacity</code></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
    , <span class="kw">fill_opacity</span> <span class="kw">=</span> <span class="st">"AREASQKM"</span>
  )</pre></body></html></div>
<div class="figure">
<img src="img/articles/fill_opacity.png" alt=""><p class="caption">fill opacity</p>
</div>
<p>Or by using a single value between 1 &amp; 255 to apply to all the shapes</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
    , <span class="kw">fill_opacity</span> <span class="kw">=</span> ( <span class="fl">255</span> / <span class="fl">2</span> )
  )</pre></body></html></div>
<div class="figure">
<img src="img/articles/fill_opacity_value.png" alt=""><p class="caption">fill opacity value</p>
</div>
</div>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works</h2>
<p>The colouring is performed by the <a href="https://github.com/symbolixau/colourvalues"><code>colourvalues</code></a> library. Feel free to browse the documentation and code if you want a deeper understanding.</p>
<p>But broadly speaking, when you supply a vector to <code>colour_values()</code>, it returns a vector of colours scaled according to the data</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="fl">1</span>:<span class="fl">10</span>)</pre></body></html></div>
<pre><code>##  [1] "#440154FF" "#482878FF" "#3E4A89FF" "#31688EFF" "#26838EFF" "#1F9D89FF"
##  [7] "#35B779FF" "#6CCE59FF" "#B4DD2CFF" "#FDE725FF"</code></pre>
<p>Here you should see the values <code>1:10</code> get coloured according to the palette you supply (the default is “viridis”). The colours are also automatically ordered against your data. So if we reverse the vector</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="fl">10</span>:<span class="fl">1</span>)</pre></body></html></div>
<pre><code>##  [1] "#FDE725FF" "#B4DD2CFF" "#6CCE59FF" "#35B779FF" "#1F9D89FF" "#26838EFF"
##  [7] "#31688EFF" "#3E4A89FF" "#482878FF" "#440154FF"</code></pre>
<p>You can see the colour assigned to <code>1</code> is the same in both cases.</p>
<p>The same is true when using different palettes</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">10</span>,<span class="fl">10</span>:<span class="fl">1</span>), <span class="kw">palette</span> <span class="kw">=</span> <span class="st">"inferno"</span>)</pre></body></html></div>
<pre><code>##  [1] "#000004FF" "#1B0C41FF" "#4B0C6BFF" "#781C6DFF" "#A52D60FF" "#CF4446FF"
##  [7] "#ED6925FF" "#FB9A06FF" "#F7D13CFF" "#FCFFA4FF" "#FCFFA4FF" "#F7D13CFF"
## [13] "#FB9A06FF" "#ED6925FF" "#CF4446FF" "#A52D60FF" "#781C6DFF" "#4B0C6BFF"
## [19] "#1B0C41FF" "#000004FF"</code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">m</span> <span class="kw">&lt;-</span> <span class="kw pkg">grDevices</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRamp</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"yellow"</span>))( (<span class="fl">1</span>:<span class="fl">256</span>)/<span class="fl">256</span> )
<span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">10</span>,<span class="fl">10</span>:<span class="fl">1</span>), <span class="kw">palette</span> <span class="kw">=</span> <span class="no">m</span>)</pre></body></html></div>
<pre><code>##  [1] "#0202FFFF" "#3A3AFFFF" "#7373FFFF" "#ABABFFFF" "#E4E4FFFF" "#FFFFE2FF"
##  [7] "#FFFFA9FF" "#FFFF71FF" "#FFFF38FF" "#FFFF00FF" "#FFFF00FF" "#FFFF38FF"
## [13] "#FFFF71FF" "#FFFFA9FF" "#FFFFE2FF" "#E4E4FFFF" "#ABABFFFF" "#7373FFFF"
## [19] "#3A3AFFFF" "#0202FFFF"</code></pre>
<p>See how the colours are mirrored to reflect the data.</p>
<p>The same ordering applies to characters, factors, dates, etc. In this example I’m colouring the letters “j” through to “a” (in the English alphabet). The colour assigned to “a” is the same as that applied to 1.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="no">letters</span>[<span class="fl">10</span>:<span class="fl">1</span>])</pre></body></html></div>
<pre><code>##  [1] "#FDE725FF" "#B4DD2CFF" "#6CCE59FF" "#35B779FF" "#1F9D89FF" "#26838EFF"
##  [7] "#31688EFF" "#3E4A89FF" "#482878FF" "#440154FF"</code></pre>
<div id="vectors-vs-scalar" class="section level3">
<h3 class="hasAnchor">
<a href="#vectors-vs-scalar" class="anchor"></a>Vectors vs scalar</h3>
<p>There is a difference in behaviour when you supply a vector for the opacity compared to when you use a single value.</p>
<p>See how these two lines produce different results</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">5</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">255</span>,<span class="fl">5</span>))</pre></body></html></div>
<pre><code>## [1] "#44015400" "#44015400" "#44015400" "#44015400" "#44015400"</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">5</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">255</span>)</pre></body></html></div>
<pre><code>## [1] "#440154FF" "#440154FF" "#440154FF" "#440154FF" "#440154FF"</code></pre>
<p>This is because one uses a vector, where all the values are 255, and the other uses a single value of 255.</p>
<p>Lke with colours, when you supply a vector for the opacity, <code>colourvalues</code> treats each element relative to the other elements and maps the opacity accordingly.</p>
<p>It does this by rescaling the values in the vector to be in [0,1] (source code is <a href="https://github.com/SymbolixAU/colourvalues/blob/master/inst/include/colourvalues/scale/scale.hpp#L37">here</a> if you want to look), then multiplies by 255.</p>
<p>The [0,255] values are then the actual opacities.</p>
<p>So in this example, since every value of the vector is the same, they all get scaled to zero, which is the most transparent opacity.</p>
<p>Here are the result in action.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">spatialwidget</span>)
<span class="no">sf</span> <span class="kw">&lt;-</span> <span class="kw pkg">spatialwidget</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/spatialwidget/man/widget_melbourne.html">widget_melbourne</a></span>
<span class="no">sf</span>$<span class="no">opacity</span> <span class="kw">&lt;-</span> <span class="fl">150</span>

<span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
    , <span class="kw">fill_opacity</span> <span class="kw">=</span> <span class="st">"opacity"</span>
  )</pre></body></html></div>
<p><img src="img/articles/opacity1.png"></p>
<p>The polygons are completely tranparent. Now if I use a single value of 150, rather than a vector, we get the desired opacity.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">spatialwidget</span>)
<span class="no">sf</span> <span class="kw">&lt;-</span> <span class="kw pkg">spatialwidget</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/spatialwidget/man/widget_melbourne.html">widget_melbourne</a></span>
<span class="no">sf</span>$<span class="no">opacity</span> <span class="kw">&lt;-</span> <span class="fl">150</span>

<span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
    , <span class="kw">fill_opacity</span> <span class="kw">=</span> <span class="fl">150</span>
    , <span class="kw">stroke_colour</span> <span class="kw">=</span> <span class="st">"SA2_NAME"</span>
  )</pre></body></html></div>
<p><img src="img/articles/opacity2.png"></p>
</div>
</div>
<div id="manual-colours" class="section level2">
<h2 class="hasAnchor">
<a href="#manual-colours" class="anchor"></a>Manual colours</h2>
<p>If you want finer control over the colours, you can add a column of colours to your data, specified as a hex string.</p>
<p>Here I’m setting all the polygons which begin with <code>A</code> as green, and the rest as red</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">sf</span>$<span class="no">my_colour</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">sf</span>$<span class="no">SA2_NAME</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">==</span> <span class="st">"A"</span>, <span class="st">"#00FF00FF"</span>, <span class="st">"#FF0000FF"</span>)

<span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>( ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/add_polygon.html">add_polygon</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf</span>
    , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"my_colour"</span>
  )</pre></body></html></div>
<div class="figure">
<img src="img/articles/fill_my_colour.png" alt=""><p class="caption">fill manual</p>
</div>
<p>Setting <code>legend = TRUE</code> in this example will just show the legend with the hex-strings, which probably isn’t what you’re after. In this case you can also create a manual legend, which I’ve described over on the <a href="https://symbolixau.github.io/mapdeck/articles/legends.html#manual-legends">legends article</a></p>
</div>
<div id="colour_range" class="section level2">
<h2 class="hasAnchor">
<a href="#colour_range" class="anchor"></a>colour_range</h2>
<p>Some layers use a <code>colour_range</code> argument instead of fill and stroke. For these layers you need to use a vector of 6 hex strings. These also default to the viridis palette.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">sf_outer</span> <span class="kw">&lt;-</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/geos_unary.html">st_convex_hull</a></span>( <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/geos_combine.html">st_union</a></span>( <span class="no">sf</span> ) )
<span class="no">sf_sample</span> <span class="kw">&lt;-</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_sample.html">st_sample</a></span>( <span class="no">sf_outer</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10000</span> )
<span class="no">sf_sample</span> <span class="kw">&lt;-</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sf/man/sf.html">st_sf</a></span>( <span class="kw">geometry</span> <span class="kw">=</span> <span class="no">sf_sample</span> )

<span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/add_hexagon.html">add_hexagon</a></span>(
        <span class="kw">data</span> <span class="kw">=</span> <span class="no">sf_sample</span>
        , <span class="kw">colour_range</span> <span class="kw">=</span> <span class="kw pkg">colourvalues</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/colourvalues/man/colour_values.html">colour_values</a></span>(<span class="fl">1</span>:<span class="fl">6</span>, <span class="kw">palette</span> <span class="kw">=</span> <span class="st">"plasma"</span>)
        , <span class="kw">elevation_scale</span> <span class="kw">=</span> <span class="fl">10</span>
    )</pre></body></html></div>
<div class="figure">
<img src="img/articles/colour_range_hexagons.png" alt=""><p class="caption">colour range</p>
</div>
</div>
<div id="geojson" class="section level2">
<h2 class="hasAnchor">
<a href="#geojson" class="anchor"></a>GeoJSON</h2>
<p>Colouring geojson is a bit different to other layers.</p>
<p>If your geojson has a <code>properties</code> field, and within that field you have one of</p>
<ul>
<li>
<code>fill_colour</code> / <code>stroke_colour</code>
</li>
<li>
<code>fillColour</code> / <code>strokeColour</code>
</li>
<li>
<code>fill_color</code> / <code>stroke_color</code>
</li>
<li>
<code>fillColor</code> / <code>strokeColor</code>
</li>
</ul>
<p>these will be automatically used and plotted</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>( <span class="kw pkg">mapdeck</span><span class="kw ns">::</span><span class="no"><a href="../reference/geojson.html">geojson</a></span>, <span class="fl">1</span>, <span class="fl">200</span>)</pre></body></html></div>
<pre><code>## [1] "{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"id\":1.0,\"fillColor\":\"#21908CFF\",\"line_colour\":\"#F89441FF\",\"random\":-0.6576371210491236},\"geometry\":{\"type\":\"LineString\",\"coordi"
## attr(,"class")
## [1] "geojson" "json"</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>( <span class="kw">location</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">145</span>, -<span class="fl">37.8</span>), <span class="kw">zoom</span> <span class="kw">=</span> <span class="fl">10</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/add_geojson.html">add_geojson</a></span>(
        <span class="kw">data</span> <span class="kw">=</span> <span class="kw pkg">mapdeck</span><span class="kw ns">::</span><span class="no"><a href="../reference/geojson.html">geojson</a></span>
    )</pre></body></html></div>
<div class="figure">
<img src="img/articles/geojson.png" alt=""><p class="caption">geojson</p>
</div>
<p>This is the quickest way of getting your data <a href="https://symbolixau.github.io/mapdeck/articles/benchmarks.html">from R to javascript</a></p>
<p>If your GeoJSON doesn’t contain those colour fields, or if you want to use a different property for colours, you can do so, but it will be a bit slower as it has to convert the geojson to an <code>sf</code> object first, sort out the colours, then back to GeoJSON</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="../reference/mapdeck.html">mapdeck</a></span>( <span class="kw">location</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">145</span>, -<span class="fl">37.8</span>), <span class="kw">zoom</span> <span class="kw">=</span> <span class="fl">10</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/add_geojson.html">add_geojson</a></span>(
        <span class="kw">data</span> <span class="kw">=</span> <span class="kw pkg">mapdeck</span><span class="kw ns">::</span><span class="no"><a href="../reference/geojson.html">geojson</a></span>
        , <span class="kw">fill_colour</span> <span class="kw">=</span> <span class="st">"id"</span>
        , <span class="kw">radius</span> <span class="kw">=</span> <span class="fl">300</span>
    )</pre></body></html></div>
<div class="figure">
<img src="img/articles/geojson_colour.png" alt=""><p class="caption">geojson colour</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Cooley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
